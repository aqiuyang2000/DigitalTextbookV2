# 数字教材加工工具(图片热区链接添加工具)

HotspotEditor 是一个功能强大的桌面应用程序，基于 Python (PySide6) 开发。它允许用户在图片或 PDF 页面上绘制交互式热区，并将其导出为多种格式的现代网页（如翻书画册、长滚动动态网页）。

该项目采用了高度模块化的 Mixin 架构，集成了自动化的 PDF 分析工具，极大地提高了制作交互式教材、目录或产品手册的效率。

## 🚀 主要特性

### 核心编辑功能
*   **多格式支持**: 支持导入 PNG, JPG, BMP 图片及 PDF 文件。
*   **交互式绘图**: 支持绘制矩形和椭圆热区，可自由拖拽、缩放（支持保持宽高比）。
*   **撤销/重做**: 完善的 Undo/Redo 系统，覆盖所有操作。
*   **属性配置**:
    *   支持跳转 **URL** 或打开 **本地文件** (音频/视频/图片/PDF)。
    *   支持配置打开方式：新标签页、当前页、**弹窗 (Popup)** 或 **嵌入 (Embed)**。
    *   自动根据文件类型匹配图标。
*   **批量操作**: 支持从 Excel 批量导入热区、批量导出数据、批量缩放热区。

### 📄 PDF 自动化工具箱
内置多个基于 `PyMuPDF` 和 `NLTK` 的智能工具，可自动分析 PDF 内容并生成热区：
*   **单词提取**: 自动识别页面单词，支持中/英文排除。
*   **句子提取**: 使用 NLP 技术自动识别并提取完整的英文句子（支持跨行）。
*   **P类单词提取**: 针对特定教材格式（如 "p. 15"）的模式匹配提取。
*   **表格提取**: 智能识别 PDF 表格单元格，支持行列合并逻辑。
*   **目录提取**: 自动分析页面布局提取目录结构到左侧提纲树。

### 📤 导出与发布
*   **双页翻书画册**: 经典的仿真翻书效果。
*   **单页翻书画册**: 适用于移动端的左右滑动/点击翻页效果。
*   **动态长网页**: 现代化的垂直滚动加载模式。
*   **片段更新**: 支持仅更新当前修改页面的 HTML 片段，无需全量导出，极大提升调试效率。
*   **实时预览**: 内置本地 HTTP 服务器，可直接在浏览器中预览导出效果。

## 🛠️ 安装指南

### 1. 环境要求
*   Python 3.8+
*   建议使用虚拟环境

### 2. 安装依赖
```bash
pip install -r requirements.txt
